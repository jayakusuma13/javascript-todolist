<!DOCTYPE html>
<html>
<head>
<title>to do javascript</title>
</head>

<body>
<div id="container">
  <p>What do you need to do?</p>
  <input type="text" id="input"></input>
  <input type="button" onclick="add()" value="Add Task"/>
  <ul id="taskList">
<!--    <li>
      <div class="list">A new task</div>
      <input type="button" onclick="erase(this)" value="Delete"/>
    </li>
    <li><div class="list">A new task</div><input type="button" onclick="erase(this)" value="Delete"/></li>-->
  </ul>

  <!--<input type="button" onclick="save()" value="Save Task"/>
  <input type="button" onclick="load()" value="Load Task"/>-->
  <ul id="loaded">
  </ul>
</div>

</body>
<script>
var input, list, store, text, button, deleteList;

  //iterate and load

    var savedTask = localStorage.getItem;

    for(i=0;i<localStorage.length-1;i++){
        input =  localStorage.getItem("task"+[i]);
        text = document.createTextNode(input);
        list = document.createElement('li');

        button = document.createElement('input');
        button.setAttribute('type','button');
        button.setAttribute('value','delete');
        button.setAttribute('onclick','erase(this)');

        paragraph = document.createElement('div');
        paragraph.setAttribute('class','list');

        paragraph.appendChild(text);
        list.appendChild(paragraph);
        list.appendChild(button);

        document.getElementById('taskList').appendChild(list);
    }

  window.onbeforeunload = closingCode;
  function closingCode(){
    save();
  }

  //iterate and save
  function save(){
    var writtenTask = document.getElementsByClassName('list');
    for(i=0;i<writtenTask.length;i++){
      localStorage.setItem("task"+[i],writtenTask[i].innerHTML);
    }
  }

  function erase(element){
    deleteList = element.parentElement.parentElement;
    //console.log(element.parentElement.getElementsByClassName('list')[0].innerHTML);
    //deleteList.style.display = "none";
    deleteList.removeChild(element.parentNode);
    for(i=0;i<localStorage.length-1;i++){
      if(localStorage.getItem("task"+[i]) == element.parentElement.getElementsByClassName('list')[0].innerHTML){
        localStorage.removeItem("task"+[i]);
      }
    }
  }

  function add(){
    input =  document.getElementById('input').value;
    document.getElementById('input').value = null;
    text = document.createTextNode(input);
    list = document.createElement('li');

    button = document.createElement('input');
    button.setAttribute('type','button');
    button.setAttribute('value','Delete');
    button.setAttribute('onclick','erase(this)');

    paragraph = document.createElement('div');
    paragraph.setAttribute('class','list');

    paragraph.appendChild(text);
    list.appendChild(paragraph);
    list.appendChild(button);

    document.getElementById('taskList').appendChild(list);
  }
</script>
</html>
